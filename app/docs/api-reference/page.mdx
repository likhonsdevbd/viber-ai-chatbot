# API Reference

Complete API documentation for Viber AI Chatbot.

## REST API Endpoints

### POST /api/chat

Send messages to the AI and receive streaming responses.

**Request Body:**
```json
{
  "messages": [
    {
      "role": "user",
      "content": "Hello, how can you help me?"
    }
  ]
}
```

**Response:**
Streaming text/event-stream with JSON chunks:
```json
{
  "choices": [
    {
      "delta": {
        "content": "Hello! I can help you..."
      }
    }
  ]
}
```

**Status Codes:**
- 200: Success
- 400: Bad Request (invalid message format)
- 500: Internal Server Error

---

### POST /api/upload

Upload files to the chat.

**Request:**
- Content-Type: multipart/form-data
- Body: FormData with 'file' field

**Response:**
```json
{
  "success": true,
  "file": {
    "name": "document.pdf",
    "type": "application/pdf",
    "size": 12345,
    "id": "file_1234567890"
  }
}
```

**Supported File Types:**
- Images: jpg, jpeg, png, gif, webp
- Documents: pdf, txt, json, csv

**File Size Limit:** 10MB

---

### POST /api/preview

Generate live preview from code.

**Request Body:**
```json
{
  "code": "<div>Hello World</div>",
  "type": "html"
}
```

**Response:**
```json
{
  "success": true,
  "html": "<!DOCTYPE html>..."
}
```

**Supported Types:**
- html
- javascript
- react

## Authentication

All authenticated requests require a valid Firebase authentication token.

```typescript
import { getAuth } from 'firebase/auth';

const auth = getAuth();
const user = auth.currentUser;
const token = await user?.getIdToken();
```

## Rate Limits

- Chat API: 60 requests per minute
- Upload API: 10 requests per minute
- Preview API: 30 requests per minute

## Error Handling

All API errors follow this format:

```json
{
  "error": {
    "code": "ERROR_CODE",
    "message": "Human readable error message"
  }
}
```

**Common Error Codes:**
- `INVALID_REQUEST`: Request validation failed
- `AUTHENTICATION_REQUIRED`: User not authenticated
- `RATE_LIMIT_EXCEEDED`: Too many requests
- `INTERNAL_ERROR`: Server error
